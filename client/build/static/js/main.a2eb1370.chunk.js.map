{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["blocks","blockid","blockname","imagesrc","plotLineLow","x0","y0","x1","y1","drawFunc","dx","dy","yi","D","y","x","plotLineHigh","xi","Vector2D","_classCallCheck","this","_createClass","key","value","othervector","number","Map","w","h","chunksize","canvasdimensions","matrix","lastchunkrequesttime","offset","chunkpixels","numchunks","startpoint","Math","floor","ceil","dimn","start","lines","coords","grid","Array","i","j","coordsobj","push","map_grid","Promise","resolve","reject","fetch","method","headers","Accept","Content-Type","body","JSON","stringify","then","res","json","chunkstore","currentchunk","concat","undefined","Chunk","chunkdata","split","currentcell","cell_i","cell_k","cell_j","cell_l","chunkcells","arguments","length","modified_cells","fill","id","modified","AppWrapper","_React$Component","props","_this","_possibleConstructorReturn","_getPrototypeOf","call","state","block_selected","update_time","tot_update_time","num_updates","cursorx","cursory","offsetx","offsety","changeBlock","setState","getBlockSelected","isSelected","changeUpdateTime","new_time","changeCursorLoc","vector","changeOffsetLoc","_inherits","document","style","overflow","getData","_this2","express_data","message","React","createElement","className","MapCanvas","Palette","position","right","round","color","Component","_React$Component2","_this3","lastChunkFetchTime","lastDrawSendTime","drawLines","cellsize","scale","canvasRef","createRef","mapoffset","celloffset","cursorcurrent","lmousedown","rmousedown","canvas","_this4","current","_this$canvas$getBound","getBoundingClientRect","width","height","chunkinterval","setTimeout","updateCanvas","event","rect","clientX","left","clientY","top","end","transform","setTo","_this5","resizeCanvas","ctx","getContext","clearRect","fillStyle","fillRect","cellapparentsize","_this$map_grid$getChu","getChunkPosOffset","doFill","k","l","c","_this6","force","Date","now","_this$map_grid$getVal","getValues","multipliedby","linestosend","setMatrix","drawMap","_canvas$getBoundingCl","_window$devicePixelRa","window","devicePixelRatio","ratio","context","currentpos","_this$map_grid$getChu2","addCell","update","newcursorcurrent","getCursorPosition","moveMap","newcurrentcell","getCurrentCell","isEqualTo","drawLine","p1","p2","_this7","abs","plotLine","drawCellAtMouse","_this8","ref","onContextMenu","e","preventDefault","onMouseDown","button","onMouseUp","onMouseMove","moveCursor","onMouseLeave","onWheel","newscale","deltaY","scaleinit","_this8$canvas$getBoun","nwidth","nheight","_React$Component3","_this9","_this10","map","backgroundColor","onClick","App","reportWebVitals","onPerfEntry","Function","__webpack_require__","bind","_ref","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","createRoot","getElementById","render","StrictMode"],"mappings":"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","file":"static/js/main.a2eb1370.chunk.js","sourcesContent":["import './App.css';\nimport React, { createRef } from 'react';\n\n\nconst blocks = [\n    {\n        blockid: 0,\n        blockname: '1',\n        imagesrc: '#ffffff'\n    },\n    {\n        blockid: 1,\n        blockname: '2',\n        imagesrc: '#d1e7dc'\n    },\n    {\n        blockid: 2,\n        blockname: '3',\n        imagesrc: '#c4d4e1'\n    },\n    {\n        blockid: 3,\n        blockname: '4',\n        imagesrc: '#bcb5d3'\n    },\n    {\n        blockid: 4,\n        blockname: '5',\n        imagesrc: '#f5dbe2'\n    },\n    {\n        blockid: 5,\n        blockname: '6',\n        imagesrc: '#eeb6c9'\n    },\n    {\n        blockid: 6,\n        blockname: '7',\n        imagesrc: '#c49abf'\n    },\n    {\n        blockid: 7,\n        blockname: '8',\n        imagesrc: '#bada55'\n    },\n    {\n        blockid: 8,\n        blockname: '9',\n        imagesrc: '#ffd700'\n    },\n    {\n        blockid: 9,\n        blockname: '10',\n        imagesrc: '#f47b79'\n    }\n];\n\nfunction plotLineLow(x0, y0, x1, y1, drawFunc) {\n    let dx = x1 - x0;\n    let dy = y1 - y0;\n    let yi = 1;\n    if (dy < 0) {\n        yi = -1;\n        dy = -dy;\n    }\n    let D = (2 * dy) - dx;\n    let y = y0;\n\n    for (let x = x0;x<x1+1;x++) {\n        drawFunc(x, y);\n        if (D > 0) {\n            y = y + yi;\n            D = D + (2 * (dy - dx));\n        } else {\n            D = D + 2*dy;\n        }\n    }\n}\nfunction plotLineHigh(x0, y0, x1, y1, drawFunc) {\n    let dx = x1 - x0;\n    let dy = y1 - y0;\n    let xi = 1;\n    if (dx < 0) {\n        xi = -1;\n        dx = -dx;\n    }\n    let D = (2 * dx) - dy;\n    let x = x0;\n\n    for (let y = y0;y<y1+1;y++) {\n        drawFunc(x, y);\n        if (D > 0) {\n            x = x + xi;\n            D = D + (2 * (dx - dy));\n        } else {\n            D = D + 2*dx;\n        }\n    }\n}\n\nfunction plotLine(p1, p2, offset, drawFunc) {\n    \n    let x0 = p1.x+offset.x;\n    let y0 = p1.y+offset.y;\n    \n    let x1 = p2.x+offset.x;\n    let y1 = p2.y+offset.y;\n\n    if (x0===x1 && y0===y1) drawFunc(x0,y0);\n\n\n    if (Math.abs(y1 - y0) < Math.abs(x1 - x0)) {\n        if (x0 > x1) plotLineLow(x1, y1, x0, y0, drawFunc);\n        else plotLineLow(x0, y0, x1, y1, drawFunc);\n    }\n    else {\n        if (y0 > y1) plotLineHigh(x1, y1, x0, y0, drawFunc);\n        else plotLineHigh(x0, y0, x1, y1, drawFunc);\n    }\n}\n\n\nclass Vector2D {\n    constructor(x,y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    transform(x,y) {\n        this.x += x;\n        this.y += y;\n    }\n\n    setTo(x,y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    isEqualTo(othervector) {\n        return (this.x===othervector.x && this.y===othervector.y);\n    }\n    notEqualTo(othervector) {\n        return (this.x!==othervector.x || this.y!==othervector.y);\n    }\n\n    positive() {\n        return (this.x >= 0 && this.y >=0);\n    }\n\n    multipliedby(number) {\n        return new Vector2D(this.x*number,this.y*number);\n    }\n    transformedby(x,y) {\n        return new Vector2D(this.x+x,this.y+y);\n    }\n}\n\n\nclass Map {\n    constructor(w, h, chunksize) {\n\n        this.canvasdimensions = new Vector2D(w,h); // establishing at start means no resizing canvas element\n        this.chunksize = chunksize;\n        this.matrix = null;\n\n        this.lastchunkrequesttime = null;\n        \n\n    }\n\n    getValues(offset, chunkpixels) {\n        let numchunks = new Vector2D(0,0);\n        let startpoint = new Vector2D(0,0);\n\n        startpoint.x = (offset.x === 0) ? 0 : Math.floor((-1*offset.x)/chunkpixels);\n        startpoint.y = (offset.y === 0) ? 0 : Math.floor((-1*offset.y)/chunkpixels);\n\n        numchunks.x = Math.ceil(this.canvasdimensions.x/chunkpixels)+1; // bit cheaty - should probs optimise\n        numchunks.y = Math.ceil(this.canvasdimensions.y/chunkpixels)+1;\n\n        return {startpoint, numchunks};\n    }\n\n    setMatrix(dimn, start, lines) {\n\n        let coords = [];\n\n        let grid = Array(dimn.x);\n        for (let i=0;i<dimn.x;i++) {\n            grid[i] = Array(dimn.y);\n            for (let j=0;j<dimn.x;j++) {\n                let coordsobj = { x: start.x+i, y: start.y+j };\n                coords.push(coordsobj);    \n            }\n        }\n\n        let map_grid = this;\n        // console.log(coords);\n        return new Promise(function(resolve, reject) {\n            fetch('/getchunks',{\n                method: 'POST',\n                headers: {'Accept': 'application/json', 'Content-Type': 'application/json'},\n                body: JSON.stringify({coords:coords, lines:lines})\n            })\n            .then((res) => res.json())\n            .then((chunkstore) => {\n                // console.log(chunkstore);\n\n                for (let i=0;i<dimn.x;i++) {\n                    for (let j=0;j<dimn.y;j++) {\n                        let currentchunk = chunkstore[`${i+start.x},${j+start.y}`];\n                        if (currentchunk !== undefined) {\n                            grid[i][j] = new Chunk(map_grid.chunksize, i+start.x, j+start.y, currentchunk.chunkdata.split(''));\n                        }\n                        else grid[i][j] = new Chunk(map_grid.chunksize, i+start.x, j+start.y);\n                    }\n                }\n                map_grid.matrix = grid;\n                resolve();\n            });\n        });\n    }\n\n    getChunkPosOffset(currentcell, chunksize, startpoint) {\n        const cell_i = Math.floor((currentcell.x/chunksize))-startpoint.x;\n        const cell_k = currentcell.x - (cell_i+startpoint.x)*chunksize;\n\n        const cell_j = Math.floor((currentcell.y/chunksize))-startpoint.y;\n        const cell_l = currentcell.y - (cell_j+startpoint.y)*chunksize;\n\n\n        return {cell_i, cell_j, cell_k, cell_l};\n    }\n}\n\nclass Chunk {\n    constructor (chunksize, x, y, chunkcells=[]) {\n        this.x = x;\n        this.y = y;\n        \n        // this.modified_cells = [];\n        if (chunkcells.length) {\n            this.modified_cells = chunkcells;\n        } else {\n            this.modified_cells = Array(chunksize*chunksize).fill('0');\n        }\n        \n    }\n\n    addCell(x,y, id) {\n        this.modified_cells[x*16+y] = id;\n        this.modified = true;\n    }\n    \n}\n\n\nclass AppWrapper extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            block_selected: 1, \n            update_time: 0,\n            tot_update_time: 0,\n            num_updates: 1,\n            cursorx: 0,\n            cursory: 0,\n            offsetx: 0,\n            offsety: 0\n        };\n\n        this.changeBlock = (blockid) => {this.setState({block_selected: blockid})};\n        this.getBlockSelected = () => {return this.state.block_selected};\n\n        this.isSelected = (blockid) => {return (blockid===this.state.block_selected)};\n\n        this.changeUpdateTime = (new_time) => {\n            this.setState({\n                update_time: new_time, \n                tot_update_time: this.state.tot_update_time+new_time, \n                num_updates: this.state.num_updates+1\n            });\n        }\n        this.changeCursorLoc = (vector) => {\n            this.setState({cursorx: vector.x,cursory: vector.y});\n        }\n        this.changeOffsetLoc = (vector) => {\n            this.setState({offsetx: vector.x,offsety: vector.y});\n        }\n    }\n\n    componentDidMount() {\n        document.body.style.overflow = \"hidden\"; // stops user from scrolling the page\n        this.getData();\n    }\n\n    getData() {\n        fetch(\"/api\")\n        .then((res) => res.json())\n        .then((express_data) => this.setState({express_data: express_data.message}));\n    }\n\n    render() {\n        return (\n            <div className='App-wrapper'>\n                <MapCanvas changeUpdateTime={this.changeUpdateTime} getBlockSelected={this.getBlockSelected} changeCursorLoc={this.changeCursorLoc} changeOffsetLoc={this.changeOffsetLoc}/>\n                <Palette isSelected={this.isSelected} changeBlock={this.changeBlock}/>\n                <div className='drawer primary'>\n                <div style={{position: `absolute`,right:`0.8vw`}}>\n                    ({this.state.update_time}ms, avg: {Math.round(this.state.tot_update_time/this.state.num_updates)}ms, {this.state.num_updates} updates)\n                    <br/>Cursor: ({this.state.cursorx},{this.state.cursory})\n                    <br/>Offset: ({this.state.offsetx},{this.state.offsety})\n                </div>\n                <b>Instructions:</b><br/>This is a pixel art canvas with infinite area. Scroll to zoom in and out, right click to pan around, and use left click to draw on the canvas.\n                <br/>Use the palette on the right to select your colour.\n                <div style={{color: `#909090`}}>(!!!!) Be aware that there is no saving yet lol, also this is just a prototype so limited colours, no drawing tools etc.</div>\n                </div>\n            </div>\n        )\n    }\n}\n\nclass MapCanvas extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.getBlockSelected = props.getBlockSelected;\n        this.changeUpdateTime = props.changeUpdateTime;\n        this.changeCursorLoc = props.changeCursorLoc;\n        this.changeOffsetLoc = props.changeOffsetLoc;\n\n        this.lastChunkFetchTime = 0;\n        this.lastDrawSendTime = 0;\n\n        this.drawLines = [];\n\n        this.cellsize = 8;\n        this.scale = 2;\n        this.chunksize = 16;\n\n        this.map_grid = null;\n        this.canvasRef = createRef();\n    \n        this.mapoffset = new Vector2D(0,0);\n        this.celloffset = new Vector2D(0,0);\n        this.currentcell = new Vector2D(0,0);\n        this.startpoint = new Vector2D(0,0);\n        this.numchunks = new Vector2D(0,0);\n\n        this.cursorcurrent = new Vector2D(0,0);\n        this.lmousedown = false;\n        this.rmousedown = false;\n\n        this.canvas = null;\n    }\n\n    //Called after element's initialisation\n    // componentDidUpdate() { this.updateCanvas() }\n    componentDidMount() { \n        this.canvas = this.canvasRef.current;\n\n        // this.resizeCanvas(this.canvas);\n        const { width, height } = this.canvas.getBoundingClientRect();\n        this.map_grid = new Map(width, height, this.chunksize);\n\n        this.chunkinterval = setTimeout(() => this.updateCanvas(true), 1000);\n        // setTimeout(()=>{this.drawinterval = setInterval(() => this.sendDraws(), 1000)}, 500);\n\n        // this.updateCanvas(true);\n    }\n\n    getCursorPosition(event, canvas) {\n        const rect = canvas.getBoundingClientRect();\n        const x = event.clientX - rect.left;\n        const y = event.clientY - rect.top;\n        const pos = new Vector2D(x,y);\n        // console.log(`cursor at (${x.toFixed(1)},${y.toFixed(1)})`);\n        return pos;\n    }\n\n    getCurrentCell() {\n        let x = Math.floor((this.cursorcurrent.x-this.mapoffset.x*this.scale)/(this.cellsize*this.scale));\n        let y = Math.floor((this.cursorcurrent.y-this.mapoffset.y*this.scale)/(this.cellsize*this.scale));\n        const pos = new Vector2D(x,y);\n        return pos;\n    }\n\n    moveMap(start, end) {\n        let x = (end.x-start.x)/this.scale;\n        let y = (end.y-start.y)/this.scale;\n        this.mapoffset.transform(x,y);\n        this.celloffset.setTo(Math.floor(this.mapoffset.x/(this.cellsize)),Math.floor(this.mapoffset.y/(this.cellsize)));\n        this.changeOffsetLoc(this.celloffset);\n    }\n\n    // maybe should be in the map class\n    drawMap (canvas, startpoint) {\n\n        this.resizeCanvas(canvas);\n        const ctx = canvas.getContext('2d');\n        ctx.clearRect(0, 0, canvas.width, canvas.height)\n        // ctx.fillStyle = \"#fff7d8\";\n        ctx.fillStyle = \"#ffffff\";\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        let cellapparentsize = this.cellsize*this.scale;\n\n        // finding location in terms of iterators of current cell\n        let {cell_i, cell_j, cell_k, cell_l} = this.map_grid.getChunkPosOffset(this.currentcell, this.chunksize, startpoint);\n\n        let blockid;\n        let x;\n        let y;\n\n        let doFill = (i,j,k,l) => {\n\n            x = ((i+startpoint.x)*this.chunksize+k)*(cellapparentsize)+this.mapoffset.x*this.scale;\n            y = ((j+startpoint.y)*this.chunksize+l)*(cellapparentsize)+this.mapoffset.y*this.scale;\n\n            ctx.fillRect(x, y, cellapparentsize, cellapparentsize);\n        }\n        if (this.map_grid.matrix === null) return;\n        // for map\n        for (let i=0;i<this.map_grid.matrix.length;i++) {\n            for (let j=0;j<this.map_grid.matrix[i].length;j++) {\n                // for each chunk\n                for (let c=0;c<(this.chunksize*this.chunksize);c++) {\n                    let k = Math.floor(c/this.chunksize);\n                    let l = c-(k*this.chunksize);\n\n                    if (typeof this.map_grid.matrix[i][j] === 'undefined') continue;\n                    blockid = this.map_grid.matrix[i][j].modified_cells[c];\n\n                    if (blockid!==\"0\"){\n                        ctx.fillStyle = blocks[blockid].imagesrc; // placeholder until get images\n                        doFill(i,j,k,l,blockid);\n                    }\n                }\n            }\n        }\n        ctx.fillStyle = blocks[this.getBlockSelected()].imagesrc+\"8f\"; // placeholder until get images\n        doFill(cell_i,cell_j,cell_k,cell_l);\n    }\n\n    updateCanvas(force=false) {\n        let start = Date.now(); // time testing\n\n        if (Date.now() >= this.lastChunkFetchTime+1000) {\n            // console.log(Date.now());\n            this.lastChunkFetchTime = Date.now();\n            let {startpoint, numchunks} = this.map_grid.getValues(this.mapoffset.multipliedby(this.scale), this.chunksize*this.cellsize*this.scale);\n            // console.log(startpoint, this.startpoint);\n            if (force) {\n                // console.log(\"querying for new chunks...\");\n                let linestosend = this.drawLines;\n                this.drawLines = [];\n                this.map_grid.setMatrix(numchunks, startpoint, linestosend)\n                .then(()=>{\n                    if (this.map_grid.matrix !== null) this.drawMap(this.canvas, startpoint);\n                    this.startpoint = startpoint;\n                    this.numchunks = numchunks;\n\n                    // console.log(this.map_grid.matrix);\n                    this.changeUpdateTime(Date.now()-start);\n                });\n            } else {\n                this.drawMap(this.canvas, startpoint);\n            }\n        }\n\n        setTimeout(()=>{this.updateCanvas(true)}, 1000);\n    }\n\n    // stolen code lmao\n    resizeCanvas(canvas) {\n        const { width, height } = canvas.getBoundingClientRect();\n        \n        if (canvas.width !== width || canvas.height !== height) {\n          const { devicePixelRatio:ratio=1 } = window;\n          const context = canvas.getContext('2d');\n          canvas.width = width*ratio;\n          canvas.height = height*ratio;\n          context.scale(ratio, ratio);\n          return true;\n        }\n    \n        return false\n    }\n\n    drawCellAtMouse(x,y) {\n        const currentpos = new Vector2D(x-this.celloffset.x,y-this.celloffset.y);\n\n        let {cell_i, cell_j, cell_k, cell_l} = this.map_grid.getChunkPosOffset(currentpos, this.chunksize, this.startpoint);\n        // console.log(`Insertion coords: x:${cell_i} y:${cell_j}`);\n        if (this.map_grid.matrix[cell_i][cell_j] !== undefined) this.map_grid.matrix[cell_i][cell_j].addCell(cell_k, cell_l, this.getBlockSelected());\n        // console.log(`cell drawn at chunk ${cell_i},${cell_j}`);\n    }\n\n    moveCursor(event) {\n        let update = false;\n        let newcursorcurrent = this.getCursorPosition(event, this.canvas);\n        if (this.rmousedown) {\n            this.moveMap(this.cursorcurrent, newcursorcurrent);\n            update = true;\n        }\n        this.cursorcurrent = newcursorcurrent;\n        let newcurrentcell = this.getCurrentCell();\n        if (!this.currentcell.isEqualTo(newcurrentcell)) {\n            if (this.lmousedown) {\n\n                // plotLine(this.currentcell, newcurrentcell, this.celloffset, (x,y)=>this.drawCellAtMouse(x,y));\n                this.drawLine(this.currentcell,newcurrentcell);\n            }\n            this.currentcell = newcurrentcell;\n            update = true;\n            this.changeCursorLoc(this.currentcell);\n        }\n        \n        return update;\n    }\n\n    drawLine(p1,p2) {\n\n        plotLine(p1, p2, this.celloffset, (x,y)=>this.drawCellAtMouse(x,y));\n\n        this.drawLines.push({p1:p1,p2:p2,offset:this.celloffset,blockid:this.getBlockSelected()});\n    }\n\n    render() {\n        return (\n            <div>\n            <canvas \n                ref={this.canvasRef} \n                className='map-canvas primary'\n                onContextMenu={(e) => {\n                    e.preventDefault();\n                    // this.rmousedown=true;\n                }}\n                onMouseDown={(e) => {\n                    e.preventDefault();\n                    if (e.button === 0) {\n                        this.lmousedown=true;\n                        this.drawLine(this.currentcell,this.currentcell);\n                        this.drawMap(this.canvas, this.startpoint);\n                    }\n                    else if (e.button === 2) {\n                        this.rmousedown=true;\n                    }\n                }}\n                onMouseUp={(e) => {\n                    this.lmousedown=false;\n                    this.rmousedown=false;\n                    this.drawMap(this.canvas, this.startpoint);\n                }}\n                onMouseMove={(e) => {\n                    let update = false;\n\n                    update = this.moveCursor(e);\n\n                    if (update) this.drawMap(this.canvas, this.startpoint);\n                }}\n                onMouseLeave={(e) => {\n                    // console.log(\"left canvas\");\n                    this.moveCursor(e);\n                    this.lmousedown=false;\n                    this.rmousedown=false;\n                    // this.currentcell.setTo(-1,-1);\n                    this.drawMap(this.canvas, this.startpoint);\n                }}\n                onWheel={(e) => {\n                    e.preventDefault();\n                    let newscale = this.scale - Math.round(e.deltaY)/1000;\n                    let scaleinit = this.scale;\n                    if (newscale>0.5) {\n                        this.scale = newscale;\n                        const { width, height } = this.canvas.getBoundingClientRect();\n                        let nwidth = width/2;\n                        let nheight = height/2;\n                        this.moveMap(new Vector2D(0,0),new Vector2D((nwidth-(nwidth*(this.scale-scaleinit))),(nheight-(nheight*(this.scale-scaleinit)))));\n                    }\n                    else this.scale = 0.5;\n                    \n                    this.drawMap(this.canvas, this.startpoint);\n                }}\n            ></canvas>\n            </div>\n        )\n    }\n}\n\n// needs to be fixed up - maybe add useEffect()\nclass Palette extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.changeBlock = props.changeBlock;\n    }\n\n    render() {\n        return (\n            <div className='palette primary'>\n                {\n                    blocks.map(button => (\n                        <div \n                            key={button.blockid} \n                            style={{backgroundColor: `${button.imagesrc}`}} \n                            className={`blockbutton` + (this.props.isSelected(button.blockid) ? \"selected\" : \"\")}\n                            onClick={() => {this.changeBlock(button.blockid)}}\n                            //onClick={() => {console.log(button.blockid)}}\n                            ></div>\n                    ))\n                }\n        </div>\n        )\n    }\n\n}\n\n\n\n\nfunction App() {\n  return (\n    <div className='App'>\n        <AppWrapper/>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}